# Label Studio 项目自动创建器使用说明

## 📖 功能概述

`project_auto_creator.py` 是一个自动化工具，能够：

- 🔍 **自动扫描**：递归扫描inputfile文件夹下的所有txt文件
- 🏗️ **批量创建**：根据每个文件名自动创建Label Studio项目
- 🏷️ **标签配置**：自动应用"文本命名实体提取标签.md"中的标签配置
- 🔗 **后端连接**：自动配置ML Backend连接用于自动标注
- 📥 **文档导入**：自动导入对应的txt文档到项目中
- 🧹 **内容清理**：导入前自动删除文档中的空行
- 📊 **进度跟踪**：实时显示创建进度和统计信息

## 🚀 快速开始

### 1. 准备工作

确保以下服务正在运行：
```bash
# 启动Label Studio (端口8080)
label-studio start

# 启动ML Backend (端口9090)
cd label-studio-ml-backend/my_ml_backend
label-studio-ml start ./
```

### 2. 配置API令牌

在 `project_auto_creator.py` 文件顶部修改配置：

```python
# Label Studio 配置
LABEL_STUDIO_URL = "http://localhost:8080"
LABEL_STUDIO_API_TOKEN = "your_api_token_here"  # 替换为您的API令牌
```

获取API令牌步骤：
1. 登录Label Studio
2. 点击右上角用户头像 → Account Settings
3. 在Access Token部分复制令牌

### 3. 运行程序

```bash
cd label-studio-ml-backend/my_ml_backend
python project_auto_creator.py
```

## 📁 文件结构要求

程序会扫描以下结构：

```
label-studio-ml-backend/
├── my_ml_backend/
│   ├── project_auto_creator.py     # 主程序
│   ├── 文本命名实体提取标签.md        # 标签配置文件
│   └── inputfile/                  # 输入文件夹
│       ├── 应急预案/
│       │   ├── 01-国家自然灾害救助应急预案.txt
│       │   ├── 02-国家防汛抗旱应急预案.txt
│       │   └── ...
│       ├── 法律法规/
│       │   ├── file1.txt
│       │   └── file2.txt
│       └── 事故信息/
│           ├── accident1.txt
│           └── accident2.txt
```

## 🎯 项目命名规则

项目名称基于文件的相对路径：

| 文件路径 | 项目名称 |
|---------|---------|
| `应急预案/01-国家自然灾害救助应急预案.txt` | `应急预案_01-国家自然灾害救助应急预案` |
| `法律法规/水污染防治法.txt` | `法律法规_水污染防治法` |
| `事故信息/flood_report.txt` | `事故信息_flood_report` |

## 📊 执行结果

程序执行完成后会显示：

```
📊 项目创建完成摘要
====================================
⏱️  总用时: 45.2秒
📁 扫描文件: 248
✅ 创建项目: 245
❌ 创建失败: 3
📥 导入成功: 242
💥 导入失败: 3

🏷️ 创建的项目列表:
   ✅ [15] 应急预案_01-国家自然灾害救助应急预案
   ✅ [16] 应急预案_02-国家防汛抗旱应急预案
   ✅ [17] 法律法规_水污染防治法
   ...

📋 项目编号列表: [15, 16, 17, 18, ...]
```

## 🔧 配置选项

在程序顶部可以调整以下配置：

```python
# 文件路径配置
INPUT_FILE_DIR = "inputfile"  # 输入文件夹
LABEL_CONFIG_FILE = "文本命名实体提取标签.md"  # 标签配置

# 项目配置
PROJECT_DESCRIPTION_TEMPLATE = "基于{filename}的文本命名实体提取项目，自动创建于{date}"
DELAY_BETWEEN_REQUESTS = 0.5  # 请求间延迟
```

## 📝 日志记录

程序会自动生成详细日志：

- 控制台输出：实时显示进度
- 日志文件：保存在 `logs/project_creator_YYYYMMDD_HHMMSS.log`

## ⚠️ 注意事项

1. **API令牌**：确保API令牌有效且有创建项目的权限
2. **服务状态**：确保Label Studio和ML Backend服务正常运行
3. **文件编码**：txt文件应使用UTF-8编码
4. **网络连接**：确保程序能访问Label Studio服务
5. **磁盘空间**：确保有足够空间存储项目和日志

## 🚨 常见问题

### Q: 创建项目失败怎么办？
A: 检查API令牌是否正确，Label Studio是否正常运行，查看日志文件了解具体错误。

### Q: 文档导入失败怎么办？
A: 检查txt文件是否为UTF-8编码，内容是否为空，文件是否被其他程序占用。

### Q: 如何修改标签配置？
A: 编辑"文本命名实体提取标签.md"文件中的XML配置部分。

### Q: 可以批量删除创建的项目吗？
A: 目前需要在Label Studio界面手动删除，或者编写额外的删除脚本。

## 📞 技术支持

遇到问题时，请：
1. 查看日志文件中的详细错误信息
2. 确认所有服务正常运行
3. 检查配置是否正确
4. 验证API令牌权限
